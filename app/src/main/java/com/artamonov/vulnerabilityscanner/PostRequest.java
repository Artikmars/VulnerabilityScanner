package com.artamonov.vulnerabilityscanner;

import android.support.annotation.NonNull;
import android.util.Log;

import java.io.IOException;
import java.net.URL;
import java.util.concurrent.TimeUnit;

import okhttp3.Call;
import okhttp3.Callback;
import okhttp3.MediaType;
import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.RequestBody;
import okhttp3.Response;

import static com.artamonov.vulnerabilityscanner.MainActivity.TAG;


public class PostRequest {

    private static final MediaType MEDIA_TYPE =
            MediaType.parse("text/plain");

    public void postToServer(String postData, URL postUrl) {


        OkHttpClient okHttpClient = new OkHttpClient()
                .newBuilder()
                .connectTimeout(10, TimeUnit.SECONDS)
                .writeTimeout(10, TimeUnit.SECONDS)
                .readTimeout(300, TimeUnit.SECONDS)
                .build();

        RequestBody body = RequestBody.create(MEDIA_TYPE,
                postData);

        Request request = new Request.Builder()
                .url(postUrl)
                .post(body)
                .build();

        okHttpClient.newCall(request).enqueue(new Callback() {
            @Override
            public void onFailure(@NonNull Call call, @NonNull IOException e) {
                Log.i(TAG, "onFailure:  " + e);
            }

            @Override
            public void onResponse(@NonNull Call call, @NonNull Response response) throws IOException {
                Log.i(TAG, "onResponse:  " + response.body().string());

            }
        });

    }

}
